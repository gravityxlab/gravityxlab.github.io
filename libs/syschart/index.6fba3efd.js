!function(){class t{constructor(t,i){this.ctx=t,this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height,this.settings=i,this.settings.config||(this.settings.config=[{chart:this.settings.chart,key:this.settings.axisRight.key}]),this.settings.axisBottom&&!this.settings.axisBottom.height&&(this.settings.axisBottom.height=40),this.settings.axisLeft&&!this.settings.axisLeft.width&&(this.settings.axisLeft.width=50),this.settings.axisRight&&!this.settings.axisRight.width&&(this.settings.axisRight.width=50)}get padding(){return{top:0,bottom:0,left:0,right:0,...this.settings.padding}}get innerTop(){return this.padding.top}get innerLeft(){return this.settings.axisLeft?this.settings.axisLeft?.width+this.padding.left:this.padding.left}get innerHeight(){return this.height-this.padding.top-this.padding.bottom-this.settings.axisBottom.height}get innerBottom(){return this.innerTop+this.innerHeight}get innerWidth(){return this.width-this.innerLeft-this.padding.right-this.settings.axisRight.width}get theme(){return{text:"#B7BDC6",...this.settings.theme}}clear(){this.padding.top&&this.ctx.clearRect(0,0,this.width,this.padding.top),this.padding.left&&this.ctx.clearRect(0,0,this.padding.left,this.height),this.padding.right&&this.ctx.clearRect(this.width-this.padding.right,0,this.padding.right,this.height)}}class i{constructor(t,i,e){this.type=t,this.chart=i,this.settings=e}get key(){return this.settings.key}get range(){return this.settings.range||["auto","auto"]}low(t){return"number"==typeof this.range[0]?this.range[0]:t}high(t){return"number"==typeof this.range[1]?this.range[1]:t}}let e=new Map([[/^(\d+)d$/,t=>864e5*parseInt(t[1],10)],[/^(\d+)h$/,t=>36e5*parseInt(t[1],10)],[/^(\d+)m$/,t=>6e4*parseInt(t[1],10)],[/^(\d+)s$/,t=>1e3*parseInt(t[1],10)]]);function s(t){for(let[i,s]of e){let e=i.exec(t);if(e)return s(e)}throw Error("No match any time format.")}function h(t,i=s("15m")){let e=(t="number"==typeof t?new Date(t):t).getHours(),n=t.getMinutes(),a=Math.floor((36e5*e+6e4*n+1e3*t.getSeconds()+t.getMilliseconds())/i);return{start:t.setHours(0,0,0,0)+a*i,end:t.setHours(0,0,0,0)+(a+1)*i}}function n(t,i=s("15m")){let{start:e,end:a}=h(t="number"==typeof t?new Date(t):t,i);return{start:e,end:a,timestamp:e+(a-e)/2}}let a={textAlign:"center",textBaseline:"middle",font:"11px Arial",fillStyle:"#B7BDC6"};function r(t,{textAlign:i=a.textAlign,textBaseline:e=a.textBaseline,font:s=a.font,fillStyle:h=a.fillStyle}=a){return(n,a,r)=>{t.textAlign=i,t.textBaseline=e,t.font=s,t.fillStyle=h,t.fillText(n,a,r)}}class o extends i{constructor(t,i){super("axis_bottom",t,i),this.left=this.chart.innerLeft,this.height=this.settings.height,this.top=this.chart.innerBottom,this.width=this.chart.innerLeft+this.chart.innerWidth,this.benchmark={point:this.chart.innerLeft+this.chart.innerWidth-20,value:null},this.tickInterval=i.interval||s("15m"),this.tickIntervalCount=i.tickIntervalCount,this.tickSizeUnit=6,this.tickCount=Math.ceil(this.chart.innerWidth/(this.tickIntervalCount*this.tickSizeUnit)),this.tickSize=this.tickIntervalCount*this.tickSizeUnit,this.ticks=[]}x(t){return this.benchmark.point+(t-this.benchmark.value)/this.tickInterval*this.tickSize}value(t){return Math.floor((t-this.benchmark.point)/this.tickSize*this.tickInterval+this.benchmark.value)}draw(t){this.chart.ctx.clearRect(this.left,this.top,this.width,this.height);let i=t.oldest?.[this.key],e=t.latest?.[this.key];if(!i||!e){let t=Date.now();i||(i=t),e||(e=t)}let s={start:h(i,this.tickInterval).start,end:h(e,this.tickInterval).end},n=[s.end];for(;n[0]-this.tickInterval>=s.start&&n.length<=this.tickCount;)n.unshift(n[0]-this.tickInterval);for(;n.length<=this.tickCount;)n.push(n[n.length-1]+this.tickInterval);this.benchmark.value=n[n.length-2],this.x(e)>this.benchmark.point&&(this.benchmark.value=e),this.chart.ctx.beginPath(),this.chart.ctx.strokeStyle="#2B3139",this.chart.ctx.lineWidth=1,this.chart.ctx.moveTo(this.left,this.top),this.chart.ctx.lineTo(this.width,this.top),this.chart.ctx.stroke(),this.ticks=n.map(t=>{let i=new Date(t);return{label:this.settings.label(i),value:i.getTime(),x:this.x(t),y:this.top+this.height/2}}),this.ticks.forEach(t=>{r(this.chart.ctx,{fillStyle:this.chart.theme.text})(t.label,t.x,t.y)})}}class l extends i{constructor(t,i,e,s){super(t,i,s),this.top=e.top,this.left=e.left,this.width=e.width,this.height=e.height,this.benchmark={point:this.chart.innerBottom-10,value:null},this.ticks=[]}get tickSize(){return Math.abs(Math.floor((this.benchmark.point-this.top-24)/4))}y(t){return Math.min(this.benchmark.point+(this.benchmark.value-t)/this.tickInterval*this.tickSize,this.chart.innerBottom-1)}draw(t){let i;this.chart.ctx.clearRect(this.left,this.top,this.width,this.height);let e=this.chart.dataStash.helpers.lowHigh(t),s=this.low(20*Math.floor(e[0]/20)),h=this.high(20*Math.ceil(e[1]/20));this.chart.ctx.beginPath(),this.chart.ctx.strokeStyle="#2B3139",this.chart.ctx.lineWidth=1,"axis_left"===this.type?(this.chart.ctx.moveTo(this.left+this.width,this.top),this.chart.ctx.lineTo(this.left+this.width,this.height)):(this.chart.ctx.moveTo(this.left,this.top),this.chart.ctx.lineTo(this.left,this.height)),0!==s&&(this.chart.ctx.moveTo(this.left,this.chart.axisBottom.top),this.chart.ctx.lineTo(this.chart.width,this.chart.axisBottom.top)),this.chart.ctx.stroke(),this.settings.unit&&r(this.chart.ctx,{fillStyle:this.chart.theme.text})(`(${this.settings.unit})`,this.left+this.width/2,this.top+10),0===s?(this.benchmark.point=this.chart.axisBottom.top,this.benchmark.value=0):this.benchmark.value=s,this.tickInterval=Math.ceil((h-s)/4);let n=[];i="axis_left"===this.type?this.chart.padding.left+this.width/2:this.left+this.width/2;for(let t=0;t<5;t++){let e=s+this.tickInterval*t,h={label:e,value:e,x:i,y:this.y(e)};n.push(h),r(this.chart.ctx,{fillStyle:this.chart.theme.text})(h.label,h.x,h.y)}this.ticks=n}}class c extends l{constructor(t,i){super("axis_right",t,{top:t.padding.top,width:i.width,left:t.innerLeft+t.innerWidth,height:t.height-t.padding.bottom},i)}}class d extends l{constructor(t,i){super("axis_left",t,{top:t.padding.top,width:i.width,left:t.padding.left,height:t.height-t.padding.bottom},i)}}class g{constructor(t){this.chart=t}draw(t,i){this.left=this.chart.innerLeft,this.top=0,this.width=this.chart.width-i.width-this.left,this.height=this.chart.innerBottom,this.chart.ctx.clearRect(this.left,this.top,this.width,this.height),this.chart.ctx.beginPath(),this.chart.ctx.strokeStyle="#2B3139",this.chart.ctx.lineWidth=1,t.ticks.forEach(t=>{t.x>i.left||(this.chart.ctx.moveTo(t.x,this.top),this.chart.ctx.lineTo(t.x,this.height))}),i.ticks.forEach(t=>{t.y>=this.chart.innerBottom-2||(this.chart.ctx.moveTo(this.left+this.chart.ctx.lineWidth,t.y),this.chart.ctx.lineTo(this.width+this.left,t.y))}),this.chart.ctx.stroke()}}let x=(t,i,e={})=>{for(let s of i)t.ctx.fillStyle=e.color,t.ctx.fillRect(...s)},u=(t,i,e)=>{let s=t.data,h=s=>{let{axisBottom:h,axisBottom:{interval:a,tickIntervalCount:r}}=t.settings,o=s[i],{start:l,end:c}=n(o.time||s[h.key],a/r),d=e.x(l),g=e.y(o),x=e.x(c)-d,u=t.innerBottom-g;return[d,g,x,u]};return{get start(){return h(s[0])},get end(){return h(s[s.length-1])},[Symbol.iterator](){let t=0;return{next(){let i=s[t++];return i?{done:!1,value:h(i)}:{done:!0,value:null}}}}}};class f{constructor(t,{onChange:i=()=>{}}){this.chart=t,this.onChange=i,this._data=new Map}get key(){return{x:this.chart.axisBottom.key,y:this.chart.axisRight.key}}get data(){return[...this._data.values()]}add(t){t=Array.isArray(t)?t:[t];for(let i=0;i<t.length;i++){let e=t[i];e.time=new Date(e[this.key.x]),this._data.set(e.t,e)}this.onChange(this.data)}get oldest(){return this.data[0]}get latest(){return this.data[this.data.length-1]}get helpers(){let t=this.key.y;return{lowHigh:i=>i.reduce((i,e)=>((void 0===i[0]||e[t]<i[0])&&(i[0]=e[t]),(void 0===i[1]||e[t]>i[1])&&(i[1]=e[t]),i),[])}}}class m{constructor(){this._settings={},this.type="bar",this.render=x,this.dataset=u,this.DataStash=f}settings(t){let i=new m;return i._settings=t,i}}let p=new m,k={gradient:!0,color:"#FCD435",lineWidth:1},y=(t,i,e)=>{let s;let h=t.ctx.createLinearGradient(0,0,0,t.innerBottom);for(let n of(h.addColorStop(0,e),h.addColorStop(1,`${e}00`),t.ctx.beginPath(),i))s?t.ctx.lineTo(n.current.x,n.current.y):(t.ctx.moveTo(n.current.x,n.current.y),s=n.current);t.ctx.lineTo(i.end.x,t.innerBottom),t.ctx.lineTo(i.start.x,t.innerBottom),t.ctx.closePath(),t.ctx.fillStyle=h,t.ctx.fill()},w=(t,i,e={})=>{let s=(e=e||k).color||k.color,h=e.lineWidth||k.lineWidth;for(let n of(e.gradient&&y(t,i,s),t.ctx.strokeStyle=s,t.ctx.lineWidth=h,t.ctx.beginPath(),i)){let i=n.next();i&&(t.ctx.moveTo(n.current.x,n.current.y),t.ctx.lineTo(i.x,i.y))}t.ctx.closePath(),t.ctx.stroke()},v=(t,i,e)=>{let{axisBottom:s}=t.settings,h=s.interval/s.tickIntervalCount*1.5,n=t.data,a=t=>({x:e.x(t.time||t[s.key]),y:e.y(t[i])});return{get start(){return a(n[0])},get end(){return a(n[n.length-1])},[Symbol.iterator](){let t=0;return{next(){let i=n[t++];return i?{done:!1,value:{current:a(i),next:()=>{let e=n[t];return e?e.t-i.t>=h?void 0:a(e):null}}}:{done:!0,value:null}}}}}};class B{constructor(){this._settings={},this.type="line",this.render=w,this.dataset=v,this.DataStash=f}settings(t){let i=new B;return i._settings=t,i}}let S=new B,b=(t,i,e={})=>{for(let e of i)t.ctx.fillStyle=e.color,t.ctx.strokeStyle=e.color,t.ctx.lineWidth=1,t.ctx.fillRect(...e.rect),t.ctx.beginPath(),t.ctx.moveTo(...e.line.p0),t.ctx.lineTo(...e.line.p1),t.ctx.closePath(),t.ctx.stroke()},C=(t,i,e)=>{let s=t.data,h=t=>{let i=e.x(t.start),s=e.y(t.open),h=e.x(t.end)-i,n=e.y(t.close)-s,a=e.x(t.t);return{rect:[i,s,h,n],line:{p0:[a,e.y(t.low)],p1:[a,e.y(t.high)]},color:n>0?"#F6465D":"#2DBC85"}};return{get start(){return h(s[0])},get end(){return h(s[s.length-1])},[Symbol.iterator](){let t=0;return{next(){let i=s[t++];return i?{done:!1,value:h(i)}:{done:!0,value:null}}}}}};class I{constructor(t,{onChange:i=()=>{}}){this.chart=t,this.onChange=i,this._data=new Map}get tickIntervalUnit(){return this.chart.axisBottom.tickInterval/this.chart.axisBottom.tickIntervalCount}get key(){return{x:this.chart.axisBottom.key,y:this.chart.axisRight.key}}get data(){return[...this._data.values()]}add(t){t=Array.isArray(t)?t:[t];for(let i=0;i<t.length;i++)this.format(t[i]);this.onChange(this.data)}format(t){let i=this.key.x,e=this.key.y,{timestamp:s,start:h,end:a}=n(t[i],this.tickIntervalUnit),r=this._data.get(s);if(r)t[e]<r.low?r.low=t[e]:t[e]>r.high&&(r.high=t[e]),r.close=t[e];else{let i=this.latest?this.latest.close:t[e];r={t:s,start:h,end:a,open:i,close:i,low:i,high:i}}this._data.set(r.t,r)}get oldest(){return this.data[0]}get latest(){return this.data[this.data.length-1]}get helpers(){return{lowHigh:t=>t.reduce((t,i)=>((void 0===t[0]||i.low<t[0])&&(t[0]=i.low),(void 0===t[1]||i.high>t[1])&&(t[1]=i.high),t),[])}}}class R{constructor(){this._settings={},this.type="candlestick",this.render=b,this.dataset=C,this.DataStash=I}settings(t){let i=new R;return i._settings=t,i}}new R;let L=new URLSearchParams(window.location.search).get("theme")||"dark",T=document.getElementById("chart");T.width=window.innerWidth,T.height=window.innerHeight,T.style.backgroundColor="dark"===L?"#151718":"#FFFFFF";let M=new class extends t{constructor(t,i){super(t,i),this.axisBottom=new o(this,this.settings.axisBottom),this.settings.config.forEach(({chart:t},i)=>{0===i&&(this.dataStash=new t.DataStash(this,{onChange:this.draw.bind(this)}))}),this.axisRight=new c(this,this.settings.axisRight),this.settings.axisLeft&&(this.axisLeft=new d(this,this.settings.axisLeft)),this.grid=new g(this)}get data(){let t=function(t,i,e){let s=0,h=t.length-1;for(;s<=h;){let n=Math.floor((s+h)/2);t[n][e]<i?s=n+1:h=n-1}return s}(this.dataStash.data,this.axisBottom.value(this.innerLeft-10),this.settings.axisBottom.key);return this.dataStash.data.slice(t)}draw(){this.axisBottom.draw(this.dataStash),this.grid.draw(this.axisBottom,this.axisRight),this.settings.config.forEach(({chart:t,key:i})=>{let e;let{render:s,dataset:h}=t;this.axisRight.settings.key===i?e={x:this.axisBottom.x.bind(this.axisBottom),y:this.axisRight.y.bind(this.axisRight)}:this.axisLeft.settings.keys.includes(i)&&(e={x:this.axisBottom.x.bind(this.axisBottom),y:this.axisLeft.y.bind(this.axisLeft)}),e&&s(this,h(this,i,e),t._settings)}),this.axisRight.draw(this.data),this.settings.axisLeft&&this.axisLeft.draw(this.data),super.clear()}}(T.getContext("2d"),{theme:{text:"dark"===L?"#B7BDC6":"#030712"},padding:{left:4,right:4},axisRight:{range:[0,12e3],key:"socket_count",unit:"Socket"},axisLeft:{width:28,range:[0,100],keys:["cpu","memory"],unit:"%"},axisBottom:{height:16,key:"t",interval:12*s("10s"),tickIntervalCount:12,label:t=>{var i;return(i="HH:mm").includes("MM")&&(i=i.replace(/MM/g,String(t.getMonth()+1).padStart(2,"0"))),i.includes("DD")&&(i=i.replace(/DD/g,String(t.getDate()).padStart(2,"0"))),i.includes("HH")&&(i=i.replace(/HH/g,String(t.getHours()).padStart(2,"0"))),i.includes("mm")&&(i=i.replace(/mm/g,String(t.getMinutes()).padStart(2,"0"))),i}},config:[{chart:p.settings({color:"#F6465D"}),key:"socket_count"},{chart:S.settings({color:"#2DBC85",lineWidth:2}),key:"cpu"},{chart:S.settings({lineWidth:2}),key:"memory"}]});M.draw(),document.addEventListener("message",t=>{let i=t.data;i&&("data"===i.event&&M.dataStash.add(i.data),window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify({status:"received",originalMessage:i})))})}();
//# sourceMappingURL=index.6fba3efd.js.map
